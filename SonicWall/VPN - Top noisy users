make_col path:lower(string(EXTRA.path))
filter
  contains(path, "sonic")
  or contains(path, "sonicwall")
  or lower(string(FIELDS.vendor)) = "sonicwall"
  or lower(string(FIELDS["neqter.type"])) = "sonicwall"

make_col sw:object(parse_json(FIELDS.value))
make_col src:sw.source

make_table
pick_col
  EventTime:parse_isotime(string(src["@timestamp"])),
  User:string(src.user)

filter not is_null(EventTime) and not is_null(User) and User != ""

aggregate group_by(User, Bucket:format_time(EventTime, 'YYYY-MM-DD')),
  Events:count(),
  FirstSeen:min(EventTime),
  LastSeen:max(EventTime)

sort desc(Events)
