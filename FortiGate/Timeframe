@ual <- @BEC {
make_col path:lower(string(EXTRA.path)) // turn into lowercase to avoid typos
filter contains(string(path), "firewall") 

make_table
pick_col
    LogSource:string("Firewall Log"), 
    EventTime:parse_isotime(
            if (contains(lower(string(EXTRA.path)), "firewall") and not is_null(FIELDS.timestamp),
                FIELDS.timestamp,
                "")
       )

aggregate group_by(LogSource),
    StartDate:format_time(min(EventTime), 'YYYY-MM-DD HH24:MI:SS'),
    EndDate:format_time(max(EventTime), 'YYYY-MM-DD HH24:MI:SS'),
    LogCount:count()
}

<- @ual {
}
