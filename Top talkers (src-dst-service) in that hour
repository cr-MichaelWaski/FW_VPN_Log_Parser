make_col path:lower(string(EXTRA.path))
filter contains(string(path), "firewall")

make_table
pick_col
  EventTime:parse_isotime(string(FIELDS.timestamp)),
  SourceIP:string(FIELDS.srcip),
  DestinationIP:string(FIELDS.dstip),
  Service:string(FIELDS.service),
  Action:string(FIELDS.action)

filter EventTime >= parse_isotime("2025-08-18T04:00:00Z")
  and EventTime <  parse_isotime("2025-08-18T05:00:00Z")

aggregate group_by(SourceIP, DestinationIP, Service, Action),
  Events:count()

sort desc(Events)
limit 200
